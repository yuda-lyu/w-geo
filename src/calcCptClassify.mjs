import each from 'lodash/each'
import get from 'lodash/get'
import isNumber from 'lodash/isNumber'
import isnum from 'wsemi/src/isnum.mjs'
import haskey from 'wsemi/src/haskey.mjs'
import isint from 'wsemi/src/isint.mjs'
import isbol from 'wsemi/src/isbol.mjs'
import isearr from 'wsemi/src/isearr.mjs'
import isfun from 'wsemi/src/isfun.mjs'
import cint from 'wsemi/src/cint.mjs'


function isPointInPolygon(p, pgs) {

    //check
    if (!isearr(p)) {
        return null
    }
    if (!isearr(pgs)) {
        return null
    }

    //x, y
    let x = p[0]
    let y = p[1]

    //b
    let b = false
    for (let i = 0, j = pgs.length - 1; i < pgs.length; j = i++) {
        let xi = pgs[i][0]
        let yi = pgs[i][1]
        let xj = pgs[j][0]
        let yj = pgs[j][1]
        let intersect = ((yi > y) !== (yj > y)) && (x < (xj - xi) * (y - yi) / (yj - yi) + xi)
        if (intersect) {
            b = !b
        }
    }

    return b
}


function getIcInfor() {
    let r = [
        {
            nameCht: '礫質砂土',
            nameEng: 'Gravelly sand',
            color: 'rgb(173, 215, 255)',
            colorLayer: '#467dec',
            min: 0,
            max: 1.31,
        },
        {
            nameCht: '砂土-純砂至粉質砂土',
            nameEng: 'Sands-clean sand to silty sand',
            color: 'rgb(193, 233, 247)',
            colorLayer: 'linear-gradient(90deg, #dad74d 0%, #467dec 100%)',
            min: 1.31,
            max: 2.05,
        },
        {
            nameCht: '混和砂土-粉質砂土至砂質粉土',
            nameEng: 'Sand mixtures-silty sand to sandy silt',
            color: 'rgb(223, 223, 247)',
            colorLayer: 'linear-gradient(90deg, #467dec 0%, #dad74d 100%)',
            min: 2.05,
            max: 2.60,
        },
        {
            nameCht: '粉土混合物-黏質粉土至粉質黏土',
            nameEng: 'Silt mixtures-clayey silt to silty clay',
            color: 'rgb(253, 223, 225)',
            colorLayer: 'linear-gradient(90deg, #ea4e2d 0%, #dad74d 100%)',
            min: 2.60,
            max: 2.95,
        },
        {
            nameCht: '黏土',
            nameEng: 'Clays',
            color: 'rgb(253, 203, 207)',
            colorLayer: '#ea4e2d',
            min: 2.95,
            max: 3.60,
        },
        {
            nameCht: '有機土',
            nameEng: 'Organic soils',
            color: 'rgb(255, 193, 227)',
            colorLayer: '#ea4e2d',
            min: 3.60,
            max: 99,
        },
    ]
    return r
}


function csfIc(Ic) {
    let int = null
    let rang = ''
    let cht = null
    let eng = null

    //check
    if (!isNumber(Ic)) {
        return {
            error: 'invalid Ic'
        }
    }

    //find
    let icis = getIcInfor()
    each(icis, (v, k) => {
        if (Ic >= v.min && Ic < v.max) {
            int = k + 1
            rang = `${v.min}~${v.max}`
            cht = v.nameCht
            eng = v.nameEng
            return false
        }
    })
    if (cht === null || eng === null) {
        return {
            error: 'invalid Ic'
        }
    }

    return {
        success: {
            int,
            rang,
            cht,
            eng,
        }
    }
}


let dtRobBqqt = { //x為Bq, y為qt(MPa)(log)
    'zone1': [
        [
            0.8042788645514245,
            -1
        ],
        [
            1.4,
            -1
        ],
        [
            1.4,
            -0.04961518419811251
        ],
        [
            1.3360639947293758,
            0.00515510285998122
        ],
        [
            0.8042788645514245,
            -1
        ]
    ],
    'zone2': [
        [
            0.22901013093819989,
            -1
        ],
        [
            0.7989205421525307,
            -1
        ],
        [
            0.535671,
            -0.732631
        ],
        [
            0.267238,
            -0.973016
        ],
        [
            0.22901013093819989,
            -1
        ]
    ],
    'zone3': [
        [
            -0.0827455,
            -0.507509
        ],
        [
            0.19919261999759594,
            -1
        ],
        [
            0.22901013093819989,
            -1
        ],
        [
            0.267238,
            -0.973016
        ],
        [
            0.535671,
            -0.732631
        ],
        [
            0.7989205421525307,
            -1
        ],
        [
            0.8042788645514245,
            -1
        ],
        [
            1.3360639947293758,
            0.00515510285998122
        ],
        [
            0.7507188345305402,
            0.5065865313087334
        ],
        [
            0.00899762,
            -0.488431
        ],
        [
            -0.0798201488308562,
            -0.39581841738701223
        ],
        [
            -0.0827455,
            -0.507509
        ]
    ],
    'zone4': [
        [
            -0.0798201488308562,
            -0.39581841738701223
        ],
        [
            0.00899762,
            -0.488431
        ],
        [
            0.75071883453054,
            0.5065865313087332
        ],
        [
            0.46563663689560464,
            0.750800002787402
        ],
        [
            0.00559973,
            -0.282387
        ],
        [
            -0.0748262901884575,
            -0.20092818800278278
        ],
        [
            -0.0776487,
            -0.312912
        ],
        [
            -0.0798201488308562,
            -0.39581841738701223
        ]
    ],
    'zone5': [
        [
            -0.0748262901884575,
            -0.20092818800278278
        ],
        [
            0.00559973,
            -0.282387
        ],
        [
            0.4656366368956047,
            0.7508000027874022
        ],
        [
            0.28177542293386015,
            0.9083032972911816
        ],
        [
            0.00559973,
            -0.0610806
        ],
        [
            -0.06726062655330566,
            0.04677010378206706
        ],
        [
            -0.0725518,
            -0.110684
        ],
        [
            -0.0748262901884575,
            -0.20092818800278278
        ]
    ],
    'zone6': [
        [
            -0.06726062655330566,
            0.04677010378206706
        ],
        [
            0.00559973,
            -0.0610806
        ],
        [
            0.28177542293386015,
            0.9083032972911816
        ],
        [
            0.219667,
            0.961508
        ],
        [
            0.19999604525814957,
            1.0454031412933176
        ],
        [
            0.00220183,
            0.247985
        ],
        [
            -0.06071692978405572,
            0.34104143783205454
        ],
        [
            -0.0623581,
            0.274695
        ],
        [
            -0.065756,
            0.0915446
        ],
        [
            -0.06726062655330566,
            0.04677010378206706
        ]
    ],
    'zone7': [
        [
            -0.06071692978405572,
            0.34104143783205454
        ],
        [
            0.00220183,
            0.247985
        ],
        [
            0.19999604525814962,
            1.0454031412933178
        ],
        [
            0.1466205435691607,
            1.2730456382928406
        ],
        [
            0.00390078,
            0.522711
        ],
        [
            -0.053725768119182775,
            0.6023554362478534
        ],
        [
            -0.0555624,
            0.54942
        ],
        [
            -0.06071692978405572,
            0.34104143783205454
        ]
    ],
    'zone8': [
        [
            -0.053725768119182775,
            0.6023554362478534
        ],
        [
            0.00390078,
            0.522711
        ],
        [
            0.1466205435691607,
            1.2730456382928403
        ],
        [
            0.09752669166574157,
            1.4824272212471161
        ],
        [
            0.00390078,
            0.866117
        ],
        [
            -0.042929930936118785,
            0.9237944636517381
        ],
        [
            -0.0453687,
            0.843223
        ],
        [
            -0.053725768119182775,
            0.6023554362478534
        ]
    ],
    'zone9': [
        [
            0,
            0.8709212639576908
        ],
        [
            0.00390078,
            0.866117
        ],
        [
            0.09752669166574157,
            1.4824272212471163
        ],
        [
            0.055798348065744074,
            1.6603954657070483
        ],
        [
            0.00390078,
            1.36215
        ],
        [
            0,
            1.3672038510406228
        ],
        [
            0,
            0.8709212639576908
        ]
    ],
    'zone10': [
        [
            0,
            1.3672038510406228
        ],
        [
            0.00390078,
            1.36215
        ],
        [
            0.055798348065744074,
            1.6603954657070483
        ],
        [
            0.0514713,
            1.67885
        ],
        [
            0.05300885596731013,
            2
        ],
        [
            0,
            2
        ],
        [
            0,
            1.3672038510406228
        ]
    ],
    'zone9,10,11,12': [
        [
            -0.042929930936118785,
            0.9237944636517381
        ],
        [
            0,
            0.8709212639576908
        ],
        [
            0,
            2
        ],
        [
            -0.029975073717927975,
            2
        ],
        [
            -0.0283792,
            1.41938
        ],
        [
            -0.035175,
            1.18
        ],
        [
            -0.042929930936118785,
            0.9237944636517381
        ]
    ]
}


let inforRobBqqt = {
    zones: dtRobBqqt,
    markers: {
        'zone1': {
            p: [1.19678, -0.727798566],

            text: '1',
        },
        'zone2': {
            p: [0.535691, -0.855211033],
            text: '2',
        },
        'zone3': {
            p: [0.633441, -0.444014891],
            text: '3',
        },
        'zone4': {
            p: [0.368489, 0.303088011],
            text: '4',
        },
        'zone5': {
            p: [0.255305, 0.511582591],
            text: '5',
        },
        'zone6': {
            p: [0.18328, 0.760617721],
            text: '6',
        },
        'zone7': {
            p: [0.136977, 1.015443588],
            text: '7',
        },
        'zone8': {
            p: [0.0983923, 1.229730464],
            text: '8',
        },
        'zone9': {
            p: [0.0495177, 1.403475708],
            text: '9',
        },
        'zone10': {
            p: [0.0186495, 1.75096559],
            text: '10',
        },
        'zone9,10,11,12': {
            p: [[-0.014791, 1.60617707], [-0.0122186, 1.189189825]],
            text: '9,<br>10,<br>11,<br>12',
        },
    },
}


let dtRobRfqt = { //Rf(%), y為qt(MPa)(log)
    zone1: [
        [0, -1],
        [2.599004449, -0.910151233],
        [2.59819, -0.9033989],
        [2.47734, -0.785331],
        [2.38066, -0.683363],
        [2.22356, -0.592129],
        [2.06647, -0.479428],
        [1.90937, -0.382826],
        [1.75227, -0.307692],
        [1.51057, -0.216458],
        [1.26888, -0.152057],
        [0.954683, -0.103757],
        [0.628399, -0.0554559999999999],
        [0.302115, -0.0232560000000001],
        [0, 0.00770169199999993],
        [0, -1],
    ],

    zone2: [
        [0, -1],
        [8, -1],
        [8, -0.312420334],
        [7.98792, -0.313059],
        [4.03625, -0.860465],
        [0, -1],
    ],

    zone3: [
        [1.91607919296796, -0.386951534430881],
        [2.06647, -0.479428],
        [2.22356, -0.592129],
        [2.38066, -0.683363],
        [2.47734, -0.785331],
        [2.59819, -0.9033989],
        [2.59900444877071, -0.910151233011032],
        [4.03625, -0.860465],
        [7.98792, -0.313059],
        [8, -0.312420334410403],
        [8, 0.73886157340706],
        [5.21686256331027, 0.74843976095338],
        [5.20846, 0.74419],
        [5.0997, 0.67442],
        [5.00302, 0.60465],
        [4.84592, 0.50805],
        [4.65257, 0.41682],
        [4.4713, 0.33095],
        [4.27795, 0.25045],
        [4.07251, 0.17531],
        [3.86707, 0.0948100000000001],
        [3.67372, 0.0357799999999999],
        [3.49245, -0.012522],
        [3.29909, -0.08229],
        [3.08157, -0.13059],
        [2.87613, -0.184258],
        [2.67069, -0.243292],
        [2.429, -0.291592],
        [2.1994, -0.334526],
        [1.91607919296796, -0.386951534430881],
    ],

    zone4: [
        [1.51477387839753, -0.218044829299632],
        [1.75227, -0.307692],
        [1.90937, -0.382826],
        [1.91607919296796, -0.386951534430881],
        [2.1994, -0.334526],
        [2.429, -0.291592],
        [2.67069, -0.243292],
        [2.87613, -0.184258],
        [3.08157, -0.13059],
        [3.29909, -0.08229],
        [3.49245, -0.012522],
        [3.67372, 0.0357799999999999],
        [3.86707, 0.0948100000000001],
        [4.07251, 0.17531],
        [4.27795, 0.25045],
        [4.4713, 0.33095],
        [4.65257, 0.41682],
        [4.84592, 0.50805],
        [5.00302, 0.60465],
        [5.0997, 0.67442],
        [5.20846, 0.74419],
        [5.21686256331027, 0.74843976095338],
        [4.89426, 0.74955],
        [4.59943743716958, 0.84244763970655],
        [4.59215, 0.84079],
        [4.41088, 0.72272],
        [4.29003, 0.63148],
        [4.14502, 0.56172],
        [4.01208, 0.48122],
        [3.87915, 0.41682],
        [3.72205, 0.35242],
        [3.56495, 0.28801],
        [3.40785, 0.23435],
        [3.19033, 0.16995],
        [2.97281, 0.11091],
        [2.7432, 0.04114],
        [2.50151, -0.012522],
        [2.22356, -0.08229],
        [1.98187, -0.135957],
        [1.7281, -0.189624],
        [1.51477387839753, -0.218044829299632],
    ],

    zone5: [
        [0.60423, -0.0500890000000001],
        [0.604258597461038, -0.053073655288784],
        [0.628399, -0.0554559999999999],
        [0.954683, -0.103757],
        [1.26888, -0.152057],
        [1.51057, -0.216458],
        [1.51477387839753, -0.218044829299632],
        [1.7281, -0.189624],
        [1.98187, -0.135957],
        [2.22356, -0.08229],
        [2.50151, -0.012522],
        [2.7432, 0.04114],
        [2.97281, 0.11091],
        [3.19033, 0.16995],
        [3.40785, 0.23435],
        [3.56495, 0.28801],
        [3.72205, 0.35242],
        [3.87915, 0.41682],
        [4.01208, 0.48122],
        [4.14502, 0.56172],
        [4.29003, 0.63148],
        [4.41088, 0.72272],
        [4.59215, 0.84079],
        [4.59943743716958, 0.84244763970655],
        [3.89979234877181, 1.06290355298692],
        [3.80665, 0.98569],
        [3.66163, 0.89982],
        [3.48036, 0.78712],
        [3.29909, 0.68515],
        [3.08157, 0.59392],
        [2.88822, 0.50805],
        [2.67069, 0.42218],
        [2.34441, 0.32021],
        [2.09063, 0.25581],
        [1.81269, 0.18068],
        [1.4864, 0.10555],
        [1.22054, 0.0518799999999999],
        [0.89426, -0.012522],
        [0.60423, -0.0500890000000001],
    ],

    zone6: [
        [0, 0.00770169230769002],
        [0.302115, -0.0232560000000001],
        [0.604258597461038, -0.053073655288784],
        [0.60423, -0.0500890000000001],
        [0.89426, -0.012522],
        [1.22054, 0.0518799999999999],
        [1.4864, 0.10555],
        [1.81269, 0.18068],
        [2.09063, 0.25581],
        [2.34441, 0.32021],
        [2.67069, 0.42218],
        [2.88822, 0.50805],
        [3.08157, 0.59392],
        [3.29909, 0.68515],
        [3.48036, 0.78712],
        [3.66163, 0.89982],
        [3.80665, 0.98569],
        [3.89979234877181, 1.06290355298692],
        [3.22606294765238, 1.27519351669947],
        [3.04532, 1.17352],
        [2.83988, 1.05546],
        [2.62236, 0.95349],
        [2.429, 0.85152],
        [2.18731, 0.76029],
        [1.9577, 0.66905],
        [1.71601, 0.58318],
        [1.42598, 0.48122],
        [1.12387, 0.38998],
        [0.809668, 0.32021],
        [0.422961, 0.23435],
        [0.0120846, 0.17531],
        [0, 0.17356],
        [0, 0.00770169230769002],
    ],

    zone7: [
        [0, 0.17356],
        [0.0120846, 0.17531],
        [0.422961, 0.23435],
        [0.809668, 0.32021],
        [1.12387, 0.38998],
        [1.42598, 0.48122],
        [1.71601, 0.58318],
        [1.9577, 0.66905],
        [2.18731, 0.76029],
        [2.429, 0.85152],
        [2.62236, 0.95349],
        [2.83988, 1.05546],
        [3.04532, 1.17352],
        [3.22606294765237, 1.27519351669947],
        [2.42760757719909, 1.52678423151461],
        [2.22356, 1.38819],
        [2.07855, 1.27549],
        [1.89728, 1.16279],
        [1.69184, 1.05009],
        [1.43807, 0.92129],
        [1.20846, 0.81932],
        [0.930514, 0.72809],
        [0.640483, 0.63685],
        [0.314199, 0.54025],
        [0, 0.48856778143308],
        [0, 0.17356],
    ],

    zone8: [
        [0, 0.48856778143308],
        [0.314199, 0.54025],
        [0.640483, 0.63685],
        [0.930514, 0.72809],
        [1.20846, 0.81932],
        [1.43807, 0.92129],
        [1.69184, 1.05009],
        [1.89728, 1.16279],
        [2.07855, 1.27549],
        [2.22356, 1.38819],
        [2.42760757719909, 1.52678423151461],
        [2.3565, 1.54919],
        [2.18731, 1.60823],
        [2.06647, 1.6458],
        [1.98187, 1.7102],
        [1.92145, 1.78533],
        [1.84894, 1.87657],
        [1.83686, 2],
        [1.78852, 1.86047],
        [1.71601, 1.72093],
        [1.60725, 1.5653],
        [1.4864, 1.44723],
        [1.34139, 1.33989],
        [1.22054, 1.24866],
        [1.06344, 1.14669],
        [0.89426, 1.07692],
        [0.712991, 0.99642],
        [0.386707, 0.91592],
        [0, 0.85689],
        [0, 0.48856778143308],
    ],

    zone9: [
        [0, 0.85689],
        [0.386707, 0.91592],
        [0.712991, 0.99642],
        [0.89426, 1.07692],
        [1.06344, 1.14669],
        [1.22054, 1.24866],
        [1.34139, 1.33989],
        [1.4864, 1.44723],
        [1.60725, 1.5653],
        [1.71601, 1.72093],
        [1.78852, 1.86047],
        [1.83686, 2],
        [1.22054, 2],
        [1.22054, 1.99463],
        [1.11178, 1.8229],
        [0.990937, 1.68873],
        [0.845921, 1.54919],
        [0.652568, 1.44723],
        [0.386707, 1.35063],
        [0, 1.25175000154968],
        [0, 0.85689],
    ],

    zone10: [
        [0, 1.25175000154968],
        [0.386707, 1.35063],
        [0.652568, 1.44723],
        [0.845921, 1.54919],
        [0.990937, 1.68873],
        [1.11178, 1.8229],
        [1.22054, 1.99463],
        [1.22054, 2],
        [0, 2],
        [0, 1.25175000154968],
    ],

    zone11: [
        [3.89979234877181, 1.06290355298692],
        [4.89426, 0.74955],
        [8, 0.73886157340706],
        [8, 2],
        [4.70091, 2],
        [4.59215, 1.65116],
        [4.41088, 1.50626],
        [4.25378, 1.38283],
        [4.13293, 1.26476],
        [3.98792, 1.13596],
        [3.89979234877181, 1.06290355298692],
    ],

    zone12: [
        [1.83686, 2],
        [1.84894, 1.87657],
        [1.92145, 1.78533],
        [1.98187, 1.7102],
        [2.06647, 1.6458],
        [2.18731, 1.60823],
        [2.3565, 1.54919],
        [3.89979234877181, 1.06290355298692],
        [3.98792, 1.13596],
        [4.13293, 1.26476],
        [4.25378, 1.38283],
        [4.41088, 1.50626],
        [4.59215, 1.65116],
        [4.70091, 2],
        [1.83686, 2],
    ],

}


let inforRobRfqt = {
    zones: dtRobRfqt,
    markers: {
        'zone1': {
            p: [0.866142, -0.534722],
            text: '1',
        },
        'zone2': {
            p: [6.61417, -0.833333],
            text: '2',
        },
        'zone3': {
            p: [5.03937, -0.083333],
            text: '3',
        },
        'zone4': {
            p: [3.66929, 0.17361],
            text: '4',
        },
        'zone5': {
            p: [2.97638, 0.3125],
            text: '5',
        },
        'zone6': {
            p: [2.31496, 0.54861],
            text: '6',
        },
        'zone7': {
            p: [1.65354, 0.8125],
            text: '7',
        },
        'zone8': {
            p: [1.24409, 1.05556],
            text: '8',
        },
        'zone9': {
            p: [0.866142, 1.32639],
            text: '9',
        },
        'zone10': {
            p: [0.393701, 1.76389],
            text: '10',
        },
        'zone11': {
            p: [6.48819, 1.48611],
            text: '11',
        },
        'zone12': {
            p: [3.51181, 1.72917],
            text: '12',
        },
    },
}


let dtRobBqQt = { //x為Bq, y為Qt(log)
    'zone1': [
        [
            0.814956350795433,
            0
        ],
        [
            1.4,
            0
        ],
        [
            1.4,
            1.0444774529587604
        ],
        [
            0.814956350795433,
            0
        ]
    ],
    'zone2': [
        [
            0.15755797913451555,
            0
        ],
        [
            0.8081353465726996,
            0
        ],
        [
            0.803677,
            0.00955108
        ],
        [
            0.542358,
            0.411052
        ],
        [
            0.163577,
            0.00955108
        ],
        [
            0.15755797913451555,
            0
        ]
    ],
    'zone3': [
        [
            -0.557635,
            1.27767
        ],
        [
            0.135961,
            0.0225141
        ],
        [
            0.14709816115300722,
            0
        ],
        [
            0.15755797913451555,
            0
        ],
        [
            0.163577,
            0.00955108
        ],
        [
            0.542358,
            0.411052
        ],
        [
            0.803677,
            0.00955108
        ],
        [
            0.8081353465726996,
            0
        ],
        [
            0.8159217107198008,
            0
        ],
        [
            0.824794,
            0.015206
        ],
        [
            1.38835,
            1.02178
        ],
        [
            1.3952840233278456,
            1.0277257015798282
        ],
        [
            0.6051580468079697,
            1.6769417299522127
        ],
        [
            0.0144398,
            0.684374
        ],
        [
            -0.389417,
            1.78897
        ],
        [
            -0.3965860167997673,
            1.8080830326156345
        ],
        [
            -0.557635,
            1.27767
        ]
    ],
    'zone4': [
        [
            -0.3965860167997673,
            1.8080830326156345
        ],
        [
            -0.389417,
            1.78897
        ],
        [
            0.0144398,
            0.684374
        ],
        [
            0.6051580468079698,
            1.6769417299522127
        ],
        [
            0.4233286829382924,
            1.8263439024676476
        ],
        [
            0.01312,
            1.05006
        ],
        [
            -0.3126662899731374,
            2.0844717183302555
        ],
        [
            -0.3965860167997673,
            1.8080830326156345
        ]
    ],
    'zone5': [
        [
            -0.3126662899731374,
            2.0844717183302555
        ],
        [
            0.01312,
            1.05006
        ],
        [
            0.4233286829382924,
            1.8263439024676478
        ],
        [
            0.23050362977173397,
            1.9847808086162937
        ],
        [
            0.01312,
            1.46853
        ],
        [
            -0.24501712858513175,
            2.307273477973186
        ],
        [
            -0.3126662899731374,
            2.0844717183302555
        ]
    ],
    'zone6': [
        [
            -0.24501712858513178,
            2.307273477973186
        ],
        [
            0.01312,
            1.46853
        ],
        [
            0.23050362977173397,
            1.9847808086162937
        ],
        [
            0.182054,
            2.02459
        ],
        [
            0.14155632003411384,
            2.4608700593991886
        ],
        [
            0.0157596,
            2.2376
        ],
        [
            -0.15640870819128455,
            2.5991043237348594
        ],
        [
            -0.24501712858513178,
            2.307273477973186
        ]
    ],
    'zone7': [
        [
            -0.15640870819128455,
            2.5991043237348594
        ],
        [
            0.0157596,
            2.2376
        ],
        [
            0.14155632003411384,
            2.4608700593991886
        ],
        [
            0.091511603746722,
            3
        ],
        [
            -0.0346850003225585,
            3
        ],
        [
            -0.15640870819128455,
            2.5991043237348594
        ]
    ]
}


let inforRobBqQt = {
    zones: dtRobBqQt,
    markers: {
        'zone1': {
            p: [1.21905, 0.455696],
            text: '1',
        },
        'zone2': {
            p: [0.491429, 0.211573],
            text: '2',
        },
        'zone3': {
            p: [0.529524, 0.922242],
            text: '3',
        },
        'zone4': {
            p: [0.346667, 1.48101],
            text: '4',
        },
        'zone5': {
            p: [0.198095, 1.67631],
            text: '5',
        },
        'zone6': {
            p: [0.0761905, 2.03436],
            text: '6',
        },
        'zone7': {
            p: [0.0609524, 2.60398],
            text: '7',
        },
    },
}


let dtRobFrQt = { //x為Fr(%)(log), y為Qt(log)
    'zone1': [
        [
            -1,
            0
        ],
        [
            0.214255,
            0
        ],
        [
            0.214255,
            0.0100411
        ],
        [
            0.20255,
            0.0539655
        ],
        [
            0.183822,
            0.106126
        ],
        [
            0.165093,
            0.155541
        ],
        [
            0.139342,
            0.213191
        ],
        [
            0.113591,
            0.276333
        ],
        [
            0.0808163,
            0.328493
        ],
        [
            0.0574059,
            0.386144
        ],
        [
            0.0269725,
            0.438304
        ],
        [
            -0.00814305,
            0.484973
        ],
        [
            -0.0385765,
            0.520662
        ],
        [
            -0.0690099,
            0.567332
        ],
        [
            -0.104125,
            0.605766
        ],
        [
            -0.143923,
            0.644199
        ],
        [
            -0.183721,
            0.677143
        ],
        [
            -0.223518,
            0.712831
        ],
        [
            -0.260975,
            0.74852
        ],
        [
            -0.300772,
            0.770482
        ],
        [
            -0.338229,
            0.797935
        ],
        [
            -0.375685,
            0.819897
        ],
        [
            -0.420165,
            0.84735
        ],
        [
            -0.459963,
            0.869312
        ],
        [
            -0.509124,
            0.894019
        ],
        [
            -0.555945,
            0.915981
        ],
        [
            -0.609789,
            0.932453
        ],
        [
            -0.651928,
            0.943434
        ],
        [
            -0.70343,
            0.959906
        ],
        [
            -0.754933,
            0.973632
        ],
        [
            -0.8158,
            0.984613
        ],
        [
            -0.871985,
            0.990104
        ],
        [
            -0.935193,
            0.998
        ],
        [
            -0.982013,
            0.995594
        ],
        [
            -1,
            0.9964730699272073
        ],
        [
            -1,
            0
        ]
    ],
    'zone2': [
        [
            0.2064750618712659,
            0.039236240054828495
        ],
        [
            0.214255,
            0.0100411
        ],
        [
            0.214255,
            0
        ],
        [
            1,
            0
        ],
        [
            1,
            0.8318045794934391
        ],
        [
            0.99382,
            0.819897
        ],
        [
            0.965727,
            0.762246
        ],
        [
            0.930612,
            0.704595
        ],
        [
            0.897837,
            0.638709
        ],
        [
            0.860381,
            0.592039
        ],
        [
            0.827606,
            0.55086
        ],
        [
            0.797173,
            0.50419
        ],
        [
            0.748011,
            0.441049
        ],
        [
            0.715237,
            0.391634
        ],
        [
            0.682462,
            0.344965
        ],
        [
            0.645006,
            0.306531
        ],
        [
            0.60989,
            0.279078
        ],
        [
            0.56541,
            0.243389
        ],
        [
            0.516249,
            0.213191
        ],
        [
            0.471769,
            0.174758
        ],
        [
            0.417925,
            0.14456
        ],
        [
            0.366422,
            0.114362
        ],
        [
            0.310238,
            0.0814182
        ],
        [
            0.261076,
            0.059456
        ],
        [
            0.2064750618712659,
            0.039236240054828495
        ]
    ],
    'zone3': [
        [
            -0.1691945840894161,
            0.6651183192180945
        ],
        [
            -0.143923,
            0.644199
        ],
        [
            -0.104125,
            0.605766
        ],
        [
            -0.0690099,
            0.567332
        ],
        [
            -0.0385765,
            0.520662
        ],
        [
            -0.00814305,
            0.484973
        ],
        [
            0.0269725,
            0.438304
        ],
        [
            0.0574059,
            0.386144
        ],
        [
            0.0808163,
            0.328493
        ],
        [
            0.113591,
            0.276333
        ],
        [
            0.139342,
            0.213191
        ],
        [
            0.165093,
            0.155541
        ],
        [
            0.183822,
            0.106126
        ],
        [
            0.20255,
            0.0539655
        ],
        [
            0.2064750618712659,
            0.039236240054828495
        ],
        [
            0.261076,
            0.059456
        ],
        [
            0.310238,
            0.0814182
        ],
        [
            0.366422,
            0.114362
        ],
        [
            0.417925,
            0.14456
        ],
        [
            0.471769,
            0.174758
        ],
        [
            0.516249,
            0.213191
        ],
        [
            0.56541,
            0.243389
        ],
        [
            0.60989,
            0.279078
        ],
        [
            0.645006,
            0.306531
        ],
        [
            0.682462,
            0.344965
        ],
        [
            0.715237,
            0.391634
        ],
        [
            0.748011,
            0.441049
        ],
        [
            0.797173,
            0.50419
        ],
        [
            0.827606,
            0.55086
        ],
        [
            0.860381,
            0.592039
        ],
        [
            0.897837,
            0.638709
        ],
        [
            0.930612,
            0.704595
        ],
        [
            0.965727,
            0.762246
        ],
        [
            0.99382,
            0.819897
        ],
        [
            1,
            0.8318045794934391
        ],
        [
            1,
            1.743385534886701
        ],
        [
            0.965727,
            1.73133
        ],
        [
            0.911883,
            1.73682
        ],
        [
            0.839311,
            1.76153
        ],
        [
            0.7838498913648442,
            1.785615676370634
        ],
        [
            0.778445,
            1.75604
        ],
        [
            0.762057,
            1.69015
        ],
        [
            0.743329,
            1.62426
        ],
        [
            0.717578,
            1.56387
        ],
        [
            0.689485,
            1.49523
        ],
        [
            0.652029,
            1.43209
        ],
        [
            0.619254,
            1.36895
        ],
        [
            0.577116,
            1.30032
        ],
        [
            0.530295,
            1.23992
        ],
        [
            0.495179,
            1.18227
        ],
        [
            0.453041,
            1.13286
        ],
        [
            0.40622,
            1.07521
        ],
        [
            0.366422,
            1.03677
        ],
        [
            0.29385,
            0.965396
        ],
        [
            0.237666,
            0.918727
        ],
        [
            0.174458,
            0.866567
        ],
        [
            0.106568,
            0.819897
        ],
        [
            0.0410187,
            0.773227
        ],
        [
            -0.0268713,
            0.732048
        ],
        [
            -0.0994434,
            0.690869
        ],
        [
            -0.1691945840894161,
            0.6651183192180945
        ]
    ],
    'zone4': [
        [
            -0.5572591210207868,
            0.9163830169648318
        ],
        [
            -0.555945,
            0.915981
        ],
        [
            -0.509124,
            0.894019
        ],
        [
            -0.459963,
            0.869312
        ],
        [
            -0.420165,
            0.84735
        ],
        [
            -0.375685,
            0.819897
        ],
        [
            -0.338229,
            0.797935
        ],
        [
            -0.300772,
            0.770482
        ],
        [
            -0.260975,
            0.74852
        ],
        [
            -0.223518,
            0.712831
        ],
        [
            -0.183721,
            0.677143
        ],
        [
            -0.1691945840894161,
            0.6651183192180945
        ],
        [
            -0.0994434,
            0.690869
        ],
        [
            -0.0268713,
            0.732048
        ],
        [
            0.0410187,
            0.773227
        ],
        [
            0.106568,
            0.819897
        ],
        [
            0.174458,
            0.866567
        ],
        [
            0.237666,
            0.918727
        ],
        [
            0.29385,
            0.965396
        ],
        [
            0.366422,
            1.03677
        ],
        [
            0.40622,
            1.07521
        ],
        [
            0.453041,
            1.13286
        ],
        [
            0.495179,
            1.18227
        ],
        [
            0.530295,
            1.23992
        ],
        [
            0.577116,
            1.30032
        ],
        [
            0.619254,
            1.36895
        ],
        [
            0.652029,
            1.43209
        ],
        [
            0.689485,
            1.49523
        ],
        [
            0.717578,
            1.56387
        ],
        [
            0.743329,
            1.62426
        ],
        [
            0.762057,
            1.69015
        ],
        [
            0.778445,
            1.75604
        ],
        [
            0.7838498913648442,
            1.785615676370634
        ],
        [
            0.776103,
            1.78898
        ],
        [
            0.733965,
            1.81918
        ],
        [
            0.689485,
            1.8631
        ],
        [
            0.652029,
            1.90428
        ],
        [
            0.614572,
            1.9482
        ],
        [
            0.5812671176412162,
            1.992142954030625
        ],
        [
            0.556046,
            1.91252
        ],
        [
            0.525613,
            1.83016
        ],
        [
            0.492838,
            1.74505
        ],
        [
            0.453041,
            1.6627
        ],
        [
            0.422607,
            1.6023
        ],
        [
            0.373446,
            1.54739
        ],
        [
            0.324284,
            1.48425
        ],
        [
            0.277463,
            1.44582
        ],
        [
            0.22596,
            1.3964
        ],
        [
            0.146365,
            1.33052
        ],
        [
            0.0714521,
            1.27012
        ],
        [
            0.00590315,
            1.20973
        ],
        [
            -0.0690099,
            1.15757
        ],
        [
            -0.134559,
            1.12188
        ],
        [
            -0.209472,
            1.07521
        ],
        [
            -0.293749,
            1.03128
        ],
        [
            -0.36398,
            1.00108
        ],
        [
            -0.445916,
            0.965396
        ],
        [
            -0.523171,
            0.929708
        ],
        [
            -0.5572591210207868,
            0.9163830169648318
        ]
    ],
    'zone5': [
        [
            -1,
            0.9964730699272073
        ],
        [
            -0.982013,
            0.995594
        ],
        [
            -0.935193,
            0.998
        ],
        [
            -0.871985,
            0.990104
        ],
        [
            -0.8158,
            0.984613
        ],
        [
            -0.754933,
            0.973632
        ],
        [
            -0.70343,
            0.959906
        ],
        [
            -0.651928,
            0.943434
        ],
        [
            -0.609789,
            0.932453
        ],
        [
            -0.5572591210207868,
            0.9163830169648318
        ],
        [
            -0.523171,
            0.929708
        ],
        [
            -0.445916,
            0.965396
        ],
        [
            -0.36398,
            1.00108
        ],
        [
            -0.293749,
            1.03128
        ],
        [
            -0.209472,
            1.07521
        ],
        [
            -0.134559,
            1.12188
        ],
        [
            -0.0690099,
            1.15757
        ],
        [
            0.00590315,
            1.20973
        ],
        [
            0.0714521,
            1.27012
        ],
        [
            0.146365,
            1.33052
        ],
        [
            0.22596,
            1.3964
        ],
        [
            0.277463,
            1.44582
        ],
        [
            0.324284,
            1.48425
        ],
        [
            0.373446,
            1.54739
        ],
        [
            0.422607,
            1.6023
        ],
        [
            0.453041,
            1.6627
        ],
        [
            0.492838,
            1.74505
        ],
        [
            0.525613,
            1.83016
        ],
        [
            0.556046,
            1.91252
        ],
        [
            0.5812671176412162,
            1.992142954030625
        ],
        [
            0.577116,
            1.99762
        ],
        [
            0.544341,
            2.0388
        ],
        [
            0.516249,
            2.10194
        ],
        [
            0.478792,
            2.14861
        ],
        [
            0.453041,
            2.20901
        ],
        [
            0.420266,
            2.2694
        ],
        [
            0.392174,
            2.3298
        ],
        [
            0.3884063655271938,
            2.33783211915801
        ],
        [
            0.375787,
            2.31607
        ],
        [
            0.343012,
            2.25018
        ],
        [
            0.305556,
            2.17332
        ],
        [
            0.263417,
            2.11018
        ],
        [
            0.223619,
            2.04429
        ],
        [
            0.165093,
            1.97291
        ],
        [
            0.113591,
            1.91526
        ],
        [
            0.062088,
            1.8631
        ],
        [
            0.00356212,
            1.8082
        ],
        [
            -0.0502817,
            1.76976
        ],
        [
            -0.111149,
            1.72584
        ],
        [
            -0.179039,
            1.67917
        ],
        [
            -0.230541,
            1.64348
        ],
        [
            -0.312478,
            1.59681
        ],
        [
            -0.40846,
            1.56387
        ],
        [
            -0.488055,
            1.53092
        ],
        [
            -0.58872,
            1.49798
        ],
        [
            -0.672997,
            1.47876
        ],
        [
            -0.773661,
            1.45955
        ],
        [
            -0.864962,
            1.44856
        ],
        [
            -0.944557,
            1.44307
        ],
        [
            -1,
            1.4377631547427059
        ],
        [
            -1,
            0.9964730699272073
        ]
    ],
    'zone6': [
        [
            -1,
            1.4377631547427059
        ],
        [
            -0.944557,
            1.44307
        ],
        [
            -0.864962,
            1.44856
        ],
        [
            -0.773661,
            1.45955
        ],
        [
            -0.672997,
            1.47876
        ],
        [
            -0.58872,
            1.49798
        ],
        [
            -0.488055,
            1.53092
        ],
        [
            -0.40846,
            1.56387
        ],
        [
            -0.312478,
            1.59681
        ],
        [
            -0.230541,
            1.64348
        ],
        [
            -0.179039,
            1.67917
        ],
        [
            -0.111149,
            1.72584
        ],
        [
            -0.0502817,
            1.76976
        ],
        [
            0.00356212,
            1.8082
        ],
        [
            0.062088,
            1.8631
        ],
        [
            0.113591,
            1.91526
        ],
        [
            0.165093,
            1.97291
        ],
        [
            0.223619,
            2.04429
        ],
        [
            0.263417,
            2.11018
        ],
        [
            0.305556,
            2.17332
        ],
        [
            0.343012,
            2.25018
        ],
        [
            0.375787,
            2.31607
        ],
        [
            0.3884063655271938,
            2.33783211915801
        ],
        [
            0.366422,
            2.3847
        ],
        [
            0.347694,
            2.42314
        ],
        [
            0.328966,
            2.47255
        ],
        [
            0.303215,
            2.51922
        ],
        [
            0.289168,
            2.56864
        ],
        [
            0.263417,
            2.62354
        ],
        [
            0.24703,
            2.66747
        ],
        [
            0.232983,
            2.71688
        ],
        [
            0.216596,
            2.75531
        ],
        [
            0.200209,
            2.81022
        ],
        [
            0.186163,
            2.85689
        ],
        [
            0.169776,
            2.9118
        ],
        [
            0.148706,
            2.95847
        ],
        [
            0.1412503458588957,
            3
        ],
        [
            -0.001459668032786902,
            3
        ],
        [
            -0.00346099,
            2.98592
        ],
        [
            -0.0385765,
            2.90356
        ],
        [
            -0.073692,
            2.83218
        ],
        [
            -0.118172,
            2.75531
        ],
        [
            -0.16031,
            2.68394
        ],
        [
            -0.200108,
            2.62354
        ],
        [
            -0.244588,
            2.57687
        ],
        [
            -0.29609,
            2.53295
        ],
        [
            -0.352275,
            2.48902
        ],
        [
            -0.403778,
            2.44784
        ],
        [
            -0.471668,
            2.40941
        ],
        [
            -0.527853,
            2.36823
        ],
        [
            -0.586379,
            2.33529
        ],
        [
            -0.649586,
            2.30509
        ],
        [
            -0.726841,
            2.27215
        ],
        [
            -0.804095,
            2.24744
        ],
        [
            -0.881349,
            2.21999
        ],
        [
            -0.956262,
            2.20077
        ],
        [
            -1,
            2.1949642579667628
        ],
        [
            -1,
            1.4377631547427059
        ]
    ],
    'zone7': [
        [
            -1,
            2.1949642579667628
        ],
        [
            -0.956262,
            2.20077
        ],
        [
            -0.881349,
            2.21999
        ],
        [
            -0.804095,
            2.24744
        ],
        [
            -0.726841,
            2.27215
        ],
        [
            -0.649586,
            2.30509
        ],
        [
            -0.586379,
            2.33529
        ],
        [
            -0.527853,
            2.36823
        ],
        [
            -0.471668,
            2.40941
        ],
        [
            -0.403778,
            2.44784
        ],
        [
            -0.352275,
            2.48902
        ],
        [
            -0.29609,
            2.53295
        ],
        [
            -0.244588,
            2.57687
        ],
        [
            -0.200108,
            2.62354
        ],
        [
            -0.16031,
            2.68394
        ],
        [
            -0.118172,
            2.75531
        ],
        [
            -0.073692,
            2.83218
        ],
        [
            -0.0385765,
            2.90356
        ],
        [
            -0.00346099,
            2.98592
        ],
        [
            -0.001459668032786902,
            3
        ],
        [
            -1,
            3
        ],
        [
            -1,
            2.1949642579667628
        ]
    ],
    'zone8': [
        [
            0.1412503458588957,
            3
        ],
        [
            0.148706,
            2.95847
        ],
        [
            0.169776,
            2.9118
        ],
        [
            0.186163,
            2.85689
        ],
        [
            0.200209,
            2.81022
        ],
        [
            0.216596,
            2.75531
        ],
        [
            0.232983,
            2.71688
        ],
        [
            0.24703,
            2.66747
        ],
        [
            0.263417,
            2.62354
        ],
        [
            0.289168,
            2.56864
        ],
        [
            0.303215,
            2.51922
        ],
        [
            0.328966,
            2.47255
        ],
        [
            0.347694,
            2.42314
        ],
        [
            0.366422,
            2.3847
        ],
        [
            0.392174,
            2.3298
        ],
        [
            0.420266,
            2.2694
        ],
        [
            0.453041,
            2.20901
        ],
        [
            0.478792,
            2.14861
        ],
        [
            0.516249,
            2.10194
        ],
        [
            0.544341,
            2.0388
        ],
        [
            0.577116,
            1.99762
        ],
        [
            0.5812671176412162,
            1.992142954030625
        ],
        [
            0.58648,
            2.0086
        ],
        [
            0.607549,
            2.08821
        ],
        [
            0.628618,
            2.17881
        ],
        [
            0.647347,
            2.26666
        ],
        [
            0.661393,
            2.36549
        ],
        [
            0.670757,
            2.45883
        ],
        [
            0.67778,
            2.54393
        ],
        [
            0.682462,
            2.63727
        ],
        [
            0.689485,
            2.74159
        ],
        [
            0.689485,
            2.84591
        ],
        [
            0.687144,
            2.93925
        ],
        [
            0.6855251525327263,
            3
        ],
        [
            0.1412503458588957,
            3
        ]
    ],
    'zone9': [
        [
            0.5812671176412162,
            1.992142954030625
        ],
        [
            0.614572,
            1.9482
        ],
        [
            0.652029,
            1.90428
        ],
        [
            0.689485,
            1.8631
        ],
        [
            0.733965,
            1.81918
        ],
        [
            0.776103,
            1.78898
        ],
        [
            0.839311,
            1.76153
        ],
        [
            0.911883,
            1.73682
        ],
        [
            0.965727,
            1.73133
        ],
        [
            1,
            1.743385534886701
        ],
        [
            1,
            3
        ],
        [
            0.6855251525327263,
            3
        ],
        [
            0.687144,
            2.93925
        ],
        [
            0.689485,
            2.84591
        ],
        [
            0.689485,
            2.74159
        ],
        [
            0.682462,
            2.63727
        ],
        [
            0.67778,
            2.54393
        ],
        [
            0.670757,
            2.45883
        ],
        [
            0.661393,
            2.36549
        ],
        [
            0.647347,
            2.26666
        ],
        [
            0.628618,
            2.17881
        ],
        [
            0.607549,
            2.08821
        ],
        [
            0.58648,
            2.0086
        ],
        [
            0.5812671176412162,
            1.992142954030625
        ]
    ],
}


let dtRobFrQtNC = [
    [
        -0.642563,
        2.38745
    ],
    [
        0.577116,
        0.24888
    ],
    [
        0.607549,
        0.218682
    ],
    [
        0.626277,
        0.207701
    ],
    [
        0.649688,
        0.204956
    ],
    [
        0.673098,
        0.207701
    ],
    [
        0.682462,
        0.229663
    ],
    [
        0.680121,
        0.259861
    ],
    [
        0.666075,
        0.292804
    ],
    [
        0.656711,
        0.309276
    ],
    [
        -0.345252,
        2.64001
    ],
    [
        -0.642563,
        2.38745
    ]
]


let inforRobFrQt = {
    zones: dtRobFrQt,
    znoeNC: dtRobFrQtNC,
    markers: {
        'zone1': {
            p: [-0.716937, 0.259459],
            text: '1',
        },
        'zone2': {
            p: [0.763341, 0.232432],
            text: '2',
        },
        'zone3': {
            p: [0.206497, 0.427027],
            text: '3',
        },
        'zone4': {
            p: [-0.141531, 0.951351],
            text: '4',
        },
        'zone5': {
            p: [-0.443155, 1.2973],
            text: '5',
        },
        'zone6': {
            p: [-0.712297, 1.85405],
            text: '6',
        },
        'zone7': {
            p: [-0.62877, 2.77297],
            text: '7',
        },
        'zone8': {
            p: [0.419954, 2.77297],
            text: '8',
        },
        'zone9': {
            p: [0.726218, 2.18919],
            text: '9',
        },
        'zoneNC': {
            p: [-0.0719, 1.679],
            text: '正常壓密(Normally consolidated)',
        },
    },
}


let dtRamBqQt = { //x為Bq, y為Qt(log)
    zone1: [[1.40104, 0], [1.40104, 1], [0.801704, 0], [1.40104, 0]],
    zone2: [
        [0.801704, 0],
        [0.539905, 0.442651],
        [0.141125, 0],
        [0.801704, 0]
    ],
    zone3: [
        [1.40104, 1],
        [0.8, 1.60253],
        [0.0303888, 1.20246],
        [0.0310289, 1],
        [-0.0304203, 1],
        [-0.0291401, 1.20408],
        [-0.6, 1.39605],
        [0.141125, 0],
        [0.539905, 0.442651],
        [0.801704, 0],
        [1.40104, 1]
    ],
    zone4a: [
        [-0.1, 3.78518],
        [-0.6, 1.39605],
        [-0.0291401, 1.20408],
        [-0.1, 3.78518]
    ],
    zone4b: [
        [0.0617535, 3.78356],
        [0.0303888, 1.20246],
        [0.8, 1.60253],
        [0.4, 2],
        [0.0617535, 3.78356]
    ],
    zone5a: [
        [-0.0304203, 3.78518],
        [-0.1, 3.78518],
        [-0.0291401, 1.20408],
        [-0.0297802, 1.31539],
        [-0.0297802, 1.70094],
        [-0.0291401, 2.2591],
        [-0.0304203, 3.78518]
    ],
    zone5b: [
        [0.0617535, 3.78356],
        [0.0297487, 3.78679],
        [0.0297487, 2.28169],
        [0.0297487, 1.72352],
        [0.031669, 1.32184],
        [0.0303888, 1.20246],
        [0.0617535, 3.78356]
    ],
    zone6: [
        [0, 1.59285],
        [-0.0297802, 1.31539],
        [-0.0291401, 1.20408],
        [-0.0304203, 1],
        [0.0310289, 1],
        [0.0303888, 1.20246],
        [0.031669, 1.32184],
        [0, 1.59285]
    ],
    zone7: [
        [0, 1.94937],
        [-0.0297802, 1.70094],
        [-0.0297802, 1.31539],
        [0, 1.59285],
        [0.031669, 1.32184],
        [0.0297487, 1.72352],
        [0, 1.94937]
    ],
    zone8: [
        [0, 2.48656],
        [-0.0291401, 2.2591],
        [-0.0297802, 1.70094],
        [0, 1.94937],
        [0.0297487, 1.72352],
        [0.0297487, 2.28169],
        [0, 2.48656]
    ],
    zone9: [
        [0.0297487, 3.78679],
        [-0.0304203, 3.78518],
        [-0.0291401, 2.2591],
        [0, 2.48656],
        [0.0297487, 2.28169],
        [0.0297487, 3.78679]
    ]
}


let inforRamBqQt = {
    zones: dtRamBqQt,
    markers: {
        zone1: { p: [1.3078, 0.298266], text: '1' },
        zone2: { p: [0.504128, 0.17341], text: '2' },
        zone3: { p: [0.795872, 0.991908], text: '3' },
        zone4a: { p: [-0.302294, 2.00462], text: '4' },
        zone4b: { p: [0.201376, 1.99769], text: '4' },
        zone5a: { p: [-0.0573394, 3.60694], text: '5' },
        zone5b: { p: [0.0472477, 3.60694], text: '5' },
        zone6: { p: [0.0059633, 1.17225], text: '6' },
        zone7: { p: [0.0059633, 1.66474], text: '7' },
        zone8: { p: [0.000458716, 2.15723], text: '8' },
        zone9: { p: [0.0059633, 3.00347], text: '9' }
    },
}


let dtRamFrQt = { //x為Fr(%)(log), y為Qt(log)
    zone1: [
        [0.170602, 0],
        [0, 0.477345],
        [-0.220456, 0.755759],
        [-0.382872, 0.855193],
        [-1, 1],
        [-1, 0],
        [0.170602, 0]
    ],
    zone2: [[1, 0], [1, 0.413708], [0.170602, 0], [1, 0]],
    zone3: [
        [1, 1.53134],
        [0.285712, 1.19327],
        [0.148527, 1.17338],
        [-1, 1],
        [-0.382872, 0.855193],
        [-0.220456, 0.755759],
        [0, 0.477345],
        [0.170602, 0],
        [1, 0.413708],
        [1, 1.53134]
    ],
    zone4: [
        [1, 3.77456],
        [0.143796, 3.77456],
        [0.285712, 1.19327],
        [1, 1.53134],
        [1, 3.77456]
    ],
    zone5: [
        [0.143796, 3.77456],
        [-0.0265037, 3.77456],
        [0.0570693, 2.49386],
        [0.09176, 1.98078],
        [0.11699, 1.60293],
        [0.148527, 1.17338],
        [0.285712, 1.19327],
        [0.143796, 3.77456]
    ],
    zone6: [
        [0.11699, 1.60293],
        [-1, 1.30066],
        [-1, 1],
        [0.148527, 1.17338],
        [0.11699, 1.60293]
    ],
    zone7: [
        [0.09176, 1.98078],
        [-1, 1.69839],
        [-1, 1.30066],
        [0.11699, 1.60293],
        [0.09176, 1.98078]
    ],
    zone8: [
        [0.0570693, 2.49386],
        [-1, 2.17567],
        [-1, 1.69839],
        [0.09176, 1.98078],
        [0.0570693, 2.49386]
    ],
    zone9: [
        [-0.0265037, 3.77456],
        [-1, 3.77456],
        [-1, 2.17567],
        [0.0570693, 2.49386],
        [-0.0265037, 3.77456]
    ]
}


let inforRamFrQt = {
    zones: dtRamFrQt,
    markers: {
        zone1: { p: [-0.520058, 0.477345], text: '1' },
        zone2: { p: [0.903837, 0.179044], text: '2' },
        zone3: { p: [0.298327, 0.696099], text: '3' },
        zone4: { p: [0.694116, 2.00862], text: '4' },
        zone5: { p: [0.129604, 2.62113], text: '5' },
        zone6: { p: [-0.521634, 1.28475], text: '6' },
        zone7: { p: [-0.521634, 1.65862], text: '7' },
        zone8: { p: [-0.521634, 2.14385], text: '8' },
        zone9: { p: [-0.524788, 2.99898], text: '9' }
    },
}


let cptClassifyBond = {
    inforRobBqqt, inforRobRfqt, inforRobBqQt, inforRobFrQt, inforRamBqQt, inforRamFrQt,
}


let kpCPTClassForRobBqRfqt = { //Robertson(1986)
    1: 'Sensitive fine grained',
    2: 'Organic material',
    3: 'Clay',
    4: 'Silty clay to clay',
    5: 'Clayey silt to silty clay',
    6: 'Sandy silt to clayey silt',
    7: 'Silty sand to sandy silt',
    8: 'Sand to silty sand',
    9: 'Sand',
    10: 'Gravelly sand to sand',
    11: 'Very stiff find grained(overconsolidated or cemented)',
    12: 'Sand to clayer sand(overconsolidated or cemented)',
    13: '9,10,11,12',
}


let kpCPTClassForRobBqFrQt = { //Robertson(1990)
    1: 'Sensitive fine grained',
    2: 'Organic soils - peats',
    3: 'Clays - clay to silty clay',
    4: 'Silt mixtures - clayey silt to silty clay',
    5: 'Sand mixtures - silty sand to sandy silt',
    6: 'Sands - clean sand to silty sand',
    7: 'Gravelly sand to sand',
    8: 'Very stiff sand to clayey sand(heavily overconsolidated or cemented)',
    9: 'Very stiff fine grained(heavily overconsolidated or cemented)',
}


let kpCPTClassForRamQt = {
    1: 'Extra sensitibe clay',
    2: 'Organic clay and peat',
    3: `Clay(su/p0'<=1)`,
    4: `Clay(su/p0'>1)`,
    5: 'Clayey sand',
    6: 'Sandy very clayey silt',
    7: 'Sandy silt',
    8: 'Silty sand',
    9: 'Clean to slightly silty sand',
}


function csfRobBqqt(Bq, qt) {

    //check
    if (!isNumber(Bq)) {
        return {
            error: 'invalid Bq'
        }
    }
    if (!isNumber(qt)) {
        return {
            error: 'invalid qt'
        }
    }
    if (Bq < -0.2 || Bq > 1.4) {
        return {
            error: 'Bq < -0.2 or Bq > 1.4'
        }
    }
    if (qt < 0.1 || qt > 100) {
        return {
            error: 'qt < 0.1 or qt > 100'
        }
    }

    //p
    let x = Bq
    let y = Math.log10(qt) //需取log10
    let p = [x, y]

    //isPointInPolygon
    let r = ''
    each(dtRobBqqt, (pgs, k) => {
        let b = isPointInPolygon(p, pgs)
        if (b) {
            r = k
            return false
        }
    })

    //check
    if (r === '') {
        return {
            error: 'no zone'
        }
    }

    //convert
    let cr = r.replace('zone', '')
    let ir = null
    if (cr === '9,10,11,12') {
        cr = '13' //複合區域給整數13方便繪圖
    }
    if (isint(cr)) {
        ir = cint(cr)
        cr = `${ir}: ${kpCPTClassForRobBqRfqt[ir]}`
    }

    return {
        success: {
            int: ir,
            msg: cr,
        },
    }
}


function csfRobRfqt(Rf, qt) {

    //check
    if (!isNumber(Rf)) {
        return {
            error: 'invalid Rf'
        }
    }
    if (!isNumber(qt)) {
        return {
            error: 'invalid qt'
        }
    }
    if (Rf < 0 || Rf > 8) {
        return {
            error: 'Rf < 0 or Rf > 8'
        }
    }
    if (qt < 0.1 || qt > 100) {
        return {
            error: 'qt < 0.1 or qt > 100'
        }
    }

    //p
    let x = Rf
    let y = Math.log10(qt) //需取log10
    let p = [x, y]

    //isPointInPolygon
    let r = ''
    each(dtRobRfqt, (pgs, k) => {
        let b = isPointInPolygon(p, pgs)
        if (b) {
            r = k
            return false
        }
    })

    //check
    if (r === '') {
        return {
            error: 'no zone'
        }
    }

    //convert
    let cr = r.replace('zone', '')
    let ir = null
    if (isint(cr)) {
        ir = cint(cr)
        cr = `${ir}: ${kpCPTClassForRobBqRfqt[ir]}`
    }

    return {
        success: {
            int: ir,
            msg: cr,
        },
    }
}


function csfRobBqQt(Bq, Qt) {

    //check
    if (!isNumber(Bq)) {
        return {
            error: 'invalid Bq'
        }
    }
    if (!isNumber(Qt)) {
        return {
            error: 'invalid Qt'
        }
    }
    if (Bq < -0.6 || Bq > 1.4) {
        return {
            error: 'Bq < -0.6 or Bq > 1.4'
        }
    }
    if (Qt < 1 || Qt > 1000) {
        return {
            error: 'Qt < 1 or Qt > 1000'
        }
    }

    //p
    let x = Bq
    let y = Math.log10(Qt) //需取log10
    let p = [x, y]

    //isPointInPolygon
    let r = ''
    each(dtRobBqQt, (pgs, k) => {
        let b = isPointInPolygon(p, pgs)
        if (b) {
            r = k
            return false
        }
    })

    //check
    if (r === '') {
        return {
            error: 'no zone'
        }
    }

    //convert
    let cr = r.replace('zone', '')
    let ir = null
    if (isint(cr)) {
        ir = cint(cr)
        cr = `${ir}: ${kpCPTClassForRobBqFrQt[ir]}`
    }

    return {
        success: {
            int: ir,
            msg: cr,
        },
    }
}


function csfRobFrQt(Fr, Qt) {

    //check
    if (!isNumber(Fr)) {
        return {
            error: 'invalid Fr'
        }
    }
    if (!isNumber(Qt)) {
        return {
            error: 'invalid Qt'
        }
    }
    if (Fr < 0.1 || Fr > 10) {
        return {
            error: 'Fr < 0.1 or Fr > 10'
        }
    }
    if (Qt < 1 || Qt > 1000) {
        return {
            error: 'Qt < 1 or Qt > 1000'
        }
    }

    //p
    let x = Math.log10(Fr) //需取log10
    let y = Math.log10(Qt) //需取log10
    let p = [x, y]

    //isPointInPolygon
    let r = ''
    each(dtRobFrQt, (pgs, k) => {
        let b = isPointInPolygon(p, pgs)
        if (b) {
            r = k
            return false
        }
    })

    //check
    if (r === '') {
        return {
            error: 'no zone'
        }
    }

    //convert
    let cr = r.replace('zone', '')
    let ir = null
    if (isint(cr)) {
        ir = cint(cr)
        cr = `${ir}: ${kpCPTClassForRobBqFrQt[ir]}`
    }

    return {
        success: {
            int: ir,
            msg: cr,
        },
    }
}


function csfRamBqQt(Bq, Qt) {

    //check
    if (!isNumber(Bq)) {
        return {
            error: 'invalid Bq'
        }
    }
    if (!isNumber(Qt)) {
        return {
            error: 'invalid Qt'
        }
    }
    if (Bq < -0.6 || Bq > 1.4) {
        return {
            error: 'Bq < -0.6 or Bq > 1.4'
        }
    }
    if (Qt < 1 || Qt > 6097.895815) {
        return {
            error: 'Qt < 1 or Qt > 6097.895815'
        }
    }

    //p
    let x = Bq
    let y = Math.log10(Qt) //需取log10
    let p = [x, y]

    //isPointInPolygon
    let r = ''
    each(dtRamBqQt, (pgs, k) => {
        let b = isPointInPolygon(p, pgs)
        if (b) {
            r = k
            return false
        }
    })

    //check
    if (r === '') {
        return {
            error: 'no zone'
        }
    }

    //convert
    let cr = r.replace('zone', '')
    cr = cr.replace('a', '') //有zone4a,zone5a得剔除a
    cr = cr.replace('b', '') //有zone4b,zone5b得剔除b
    let ir = null
    if (isint(cr)) {
        ir = cint(cr)
        cr = `${ir}: ${kpCPTClassForRamQt[ir]}`
    }

    return {
        success: {
            int: ir,
            msg: cr,
        },
    }
}


function csfRamFrQt(Fr, Qt) {

    //check
    if (!isNumber(Fr)) {
        return {
            error: 'invalid Fr'
        }
    }
    if (!isNumber(Qt)) {
        return {
            error: 'invalid Qt'
        }
    }
    if (Fr < 0.1 || Fr > 10) {
        return {
            error: 'Fr < 0.1 or Fr > 10'
        }
    }
    if (Qt < 1 || Qt > 5950.589615) {
        return {
            error: 'Qt < 1 or Qt > 5950.589615'
        }
    }

    //p
    let x = Math.log10(Fr) //需取log10
    let y = Math.log10(Qt) //需取log10
    let p = [x, y]

    //isPointInPolygon
    let r = ''
    each(dtRamFrQt, (pgs, k) => {
        let b = isPointInPolygon(p, pgs)
        if (b) {
            r = k
            return false
        }
    })

    // 輸出測試資料
    // each(dtRamFrQt, (pgs, k) => {
    //     let pgst = []
    //     each(pgs, (v) => {
    //         pgst.push([
    //             10 ** v[0],
    //             10 ** v[1],
    //         ])
    //     })
    //     console.log(k, pgst)
    // })

    //check
    if (r === '') {
        return {
            error: 'no zone'
        }
    }

    //convert
    let cr = r.replace('zone', '')
    let ir = null
    if (isint(cr)) {
        ir = cint(cr)
        cr = `${ir}: ${kpCPTClassForRamQt[ir]}`
    }

    return {
        success: {
            int: ir,
            msg: cr,
        },
    }
}


function simplifyRobertson1986Core(ram, opt = {}) {
    // 1: 'Sensitive fine grained',
    // 2: 'Organic material',
    // 3: 'Clay',
    // 4: 'Silty clay to clay',
    // 5: 'Clayey silt to silty clay',
    // 6: 'Sandy silt to clayey silt',
    // 7: 'Silty sand to sandy silt',
    // 8: 'Sand to silty sand',
    // 9: 'Sand',
    // 10: 'Gravelly sand to sand',
    // 11: 'Very stiff find grained(overconsolidated or cemented)',
    // 12: 'Sand to clayer sand(overconsolidated or cemented)',
    // 13: '9,10,11,12',

    //numOfType
    let numOfType = get(opt, 'numOfType')
    if (numOfType !== 3 && numOfType !== 4 && numOfType !== 5 && numOfType !== 6) {
        console.log(`invalid numOfType[${numOfType}]`)
        numOfType = 3
    }

    //funAdjust
    let funAdjust = get(opt, 'funAdjust')

    //check
    if (!isnum(ram)) {
        return ''
    }

    //計算對應分類
    let c = ''
    let i = cint(ram)
    if (numOfType === 3) { //簡化之3種土壤單元
        let kp = {
            1: 'clay',
            2: 'clay',
            3: 'clay',
            4: 'silt',
            5: 'silt',
            6: 'silt',
            7: 'silt',
            8: 'sand',
            9: 'sand',
            10: 'sand',
            11: 'sand',
            12: 'sand',
            13: 'sand',
        }
        if (haskey(kp, i)) {
            if (isfun(funAdjust)) {
                i = funAdjust(i, kp, opt)
            }
            c = kp[i]
        }
    }
    else if (numOfType === 4) { //前期的4種工程土壤單元
        let kp = {
            1: 'clay',
            2: 'clay',
            3: 'clay',
            4: 'silt',
            5: 'clayey-silt',
            6: 'clayey-silt',
            7: 'sandy-silt',
            8: 'sandy-silt',
            9: 'sand',
            10: 'sand',
            11: 'sand',
            12: 'sand',
            13: 'sand',
        }
        if (haskey(kp, i)) {
            if (isfun(funAdjust)) {
                i = funAdjust(i, kp, opt)
            }
            c = kp[i]
        }
    }
    else if (numOfType === 5) { //前期的5種基本土壤單元(其中silt此處用clayey-silt)
        let kp = {
            1: 'clay',
            2: 'clay',
            3: 'clay',
            4: 'silt',
            5: 'clayey-silt',
            6: 'clayey-silt',
            7: 'sandy-silt',
            8: 'silty-sand',
            9: 'sand',
            10: 'sand',
            11: 'silty-sand', //clayey-sand需被視為silty-sand
            12: 'sand',
            13: 'sand',
        }
        if (haskey(kp, i)) {
            if (isfun(funAdjust)) {
                i = funAdjust(i, kp, opt)
            }
            c = kp[i]
        }
    }
    else if (numOfType === 6) { //6種基本土壤單元, 主要為前期的4種基本土壤單元(其中silt此處用clayey-silt)+由silty-sand分開的silty-sand與clayey-sand
        let kp = {
            1: 'clay',
            2: 'clay',
            3: 'clay',
            4: 'silt',
            5: 'clayey-silt',
            6: 'clayey-silt',
            7: 'sandy-silt',
            8: 'silty-sand',
            9: 'sand',
            10: 'sand',
            11: 'clayey-sand',
            12: 'sand',
            13: 'sand',
        }
        if (haskey(kp, i)) {
            if (isfun(funAdjust)) {
                i = funAdjust(i, kp, opt)
            }
            c = kp[i]
        }
    }
    return c
}


function simplifyRobertson1986(iRobFrQt, iRobBqQt, opt = {}) {

    //returnZone
    let returnZone = get(opt, 'returnZone')
    if (!isbol(returnZone)) {
        returnZone = false
    }

    //cint
    if (isnum(iRobFrQt)) {
        iRobFrQt = cint(iRobFrQt)
    }
    else {
        iRobFrQt = null
    }
    if (isnum(iRobBqQt)) {
        iRobBqQt = cint(iRobBqQt)
    }
    else {
        iRobBqQt = null
    }

    //simplifyRobertson1986Core
    let cFrQt = simplifyRobertson1986Core(iRobFrQt, opt)
    // console.log('simplifyRobertson1986Core cFrQt', cFrQt)
    let cBqQt = simplifyRobertson1986Core(iRobBqQt, opt)
    // console.log('simplifyRobertson1986Core cBqQt', cBqQt)

    if (iRobFrQt === null && iRobBqQt === null) {
        return ''
    }
    else if (iRobFrQt !== null && iRobBqQt === null) {
        return returnZone ? iRobFrQt : cFrQt
    }
    else if (iRobFrQt === null && iRobBqQt !== null) {
        return returnZone ? iRobBqQt : cBqQt
    }
    else if (cFrQt !== cBqQt) {
        //6,7,8,9,10,11,12,13視為砂性其他黏性, 若cFrQt與cBqQt皆為砂性則使用cBqQt, 反之則使用cFrQt
        let iRobFrQtIsSandy = iRobFrQt >= 6
        let iRobBqQtIsSandy = iRobBqQt >= 6
        if (iRobFrQtIsSandy && iRobBqQtIsSandy) {
            return returnZone ? iRobBqQt : cBqQt //皆砂性故使用cBqQt
        }
        else if (!iRobFrQtIsSandy && !iRobBqQtIsSandy) {
            return returnZone ? iRobFrQt : cFrQt //皆黏性故使用cFrQt
        }
        return '' //FrQt與BqQt分類不同, 兩者又是砂與黏性不同, 故視為無效分類, 交由其他深度做判斷
    }
    else {
        return returnZone ? iRobFrQt : cFrQt
    }
}


function simplifyRobertson1990Core(ram, opt = {}) {
    // 1: 'Sensitive fine grained',
    // 2: 'Organic soils - peats',
    // 3: 'Clays - clay to silty clay',
    // 4: 'Silt mixtures - clayey silt to silty clay',
    // 5: 'Sand mixtures - silty sand to sandy silt',
    // 6: 'Sands - clean sand to silty sand',
    // 7: 'Gravelly sand to sand',
    // 8: 'Very stiff sand to clayey sand(heavily overconsolidated or cemented)',
    // 9: 'Very stiff fine grained(heavily overconsolidated or cemented)',

    //numOfType
    let numOfType = get(opt, 'numOfType')
    if (numOfType !== 3 && numOfType !== 4 && numOfType !== 5 && numOfType !== 6) {
        console.log(`invalid numOfType[${numOfType}]`)
        numOfType = 3
    }

    //funAdjust
    let funAdjust = get(opt, 'funAdjust')

    //check
    if (!isnum(ram)) {
        return ''
    }

    //計算對應分類
    let c = ''
    let i = cint(ram)
    if (numOfType === 3) { //簡化之3種土壤單元
        let kp = {
            1: 'clay',
            2: 'clay',
            3: 'clay',
            4: 'silt',
            5: 'silt',
            6: 'sand',
            7: 'sand',
            8: 'sand',
            9: 'sand',
        }
        if (haskey(kp, i)) {
            if (isfun(funAdjust)) {
                i = funAdjust(i, kp, opt)
            }
            c = kp[i]
        }
    }
    else if (numOfType === 4) { //前期的4種工程土壤單元
        let kp = {
            1: 'clay',
            2: 'clay',
            3: 'clay',
            4: 'clayey-silt',
            5: 'sandy-silt',
            6: 'sand',
            7: 'sand',
            8: 'sand',
            9: 'sand',
        }
        if (haskey(kp, i)) {
            if (isfun(funAdjust)) {
                i = funAdjust(i, kp, opt)
            }
            c = kp[i]
        }
    }
    else if (numOfType === 5) { //前期的5種基本土壤單元(其中silt此處用clayey-silt)
        let kp = {
            1: 'clay',
            2: 'clay',
            3: 'clay',
            4: 'clayey-silt',
            5: 'sandy-silt',
            6: 'silty-sand',
            7: 'sand',
            8: 'silty-sand', //clayey-sand需被視為silty-sand
            9: 'sand',
        }
        // if (haskey(kp, i)) {

        //本期指定調整Robertson1990分類內4,5區, 使成為更多砂性土 (2022/01/21)
        // if (isbol(funAdjust) && funAdjust) {
        //     //dtCpt
        //     let dtCpt = get(opt, 'data')
        //     // console.log('dtCpt', dtCpt)
        //     //Ic
        //     let Ic = get(dtCpt, 'Ic', null)
        //     //check
        //     if (isnum(Ic)) {
        //         Ic = cdbl(Ic)
        //         if (i === 4) {
        //             // z4.push(Ic)
        //             // let avgz4 = arrAverage(z4)
        //             // let minz4 = min(z4)
        //             // let maxz4 = max(z4)
        //             // console.log('avgz4', avgz4, 'minz4', minz4, 'maxz4', maxz4)
        //             // avgz4 2.6757261922607447 minz4 2.225386412132727 maxz4 3.349930258953688
        //             if (Ic < 2.7) {
        //                 i = 5 //改為5區(Sand mixtures - silty sand to sandy silt)
        //             }
        //         }
        //         else if (i === 5) {
        //             // z5.push(Ic)
        //             // let avgz5 = arrAverage(z5)
        //             // let minz5 = min(z5)
        //             // let maxz5 = max(z5)
        //             // console.log('avgz5', avgz5, 'minz5', minz5, 'maxz5', maxz5)
        //             // avgz5 2.362902619191723 minz5 1.9304912179415104 maxz5 2.956499322237094
        //             if (Ic < 2.4) {
        //                 i = 6 //改為6區(Sands - clean sand to silty sand)
        //             }
        //         }
        //     }

        //     // }

        //     return kp[i]
        // }
        if (haskey(kp, i)) {
            if (isfun(funAdjust)) {
                i = funAdjust(i, kp, opt)
            }
            c = kp[i]
        }
    }
    else if (numOfType === 6) { //6種基本土壤單元, 主要為前期的4種基本土壤單元(其中silt此處用clayey-silt)+由silty-sand分開的silty-sand與clayey-sand
        let kp = {
            1: 'clay',
            2: 'clay',
            3: 'clay',
            4: 'clayey-silt',
            5: 'sandy-silt',
            6: 'silty-sand',
            7: 'sand',
            8: 'clayey-sand',
            9: 'sand',
        }
        if (haskey(kp, i)) {
            if (isfun(funAdjust)) {
                i = funAdjust(i, kp, opt)
            }
            c = kp[i]
        }
    }
    return c
}


function simplifyRobertson1990(iRobFrQt, iRobBqQt, opt = {}) {

    //returnZone
    let returnZone = get(opt, 'returnZone')
    if (!isbol(returnZone)) {
        returnZone = false
    }

    //cint
    if (isnum(iRobFrQt)) {
        iRobFrQt = cint(iRobFrQt)
    }
    else {
        iRobFrQt = null
    }
    if (isnum(iRobBqQt)) {
        iRobBqQt = cint(iRobBqQt)
    }
    else {
        iRobBqQt = null
    }

    //simplifyRobertson1990Core
    let cFrQt = simplifyRobertson1990Core(iRobFrQt, opt)
    // console.log('simplifyRobertson1990Core cFrQt', cFrQt)
    let cBqQt = simplifyRobertson1990Core(iRobBqQt, opt)
    // console.log('simplifyRobertson1990Core cBqQt', cBqQt)

    if (iRobFrQt === null && iRobBqQt === null) {
        return ''
    }
    else if (iRobFrQt !== null && iRobBqQt === null) {
        return returnZone ? iRobFrQt : cFrQt
    }
    else if (iRobFrQt === null && iRobBqQt !== null) {
        return returnZone ? iRobBqQt : cBqQt
    }
    else if (cFrQt !== cBqQt) {
        //6,7,8,9視為砂性其他黏性, 若cFrQt與cBqQt皆為砂性則使用cBqQt, 反之則使用cFrQt
        let iRobFrQtIsSandy = iRobFrQt >= 6
        let iRobBqQtIsSandy = iRobBqQt >= 6
        if (iRobFrQtIsSandy && iRobBqQtIsSandy) {
            return returnZone ? iRobBqQt : cBqQt //皆砂性故使用cBqQt
        }
        else if (!iRobFrQtIsSandy && !iRobBqQtIsSandy) {
            return returnZone ? iRobFrQt : cFrQt //皆黏性故使用cFrQt
        }
        return '' //FrQt與BqQt分類不同, 兩者又是砂與黏性不同, 故視為無效分類, 交由其他深度做判斷
    }
    else {
        return returnZone ? iRobFrQt : cFrQt
    }
}


function simplifyRobertson2009(iRobFrQtn, iRobBqQtn, opt = {}) {
    return simplifyRobertson1990(iRobFrQtn, iRobBqQtn, opt)
}


function simplifyRamseyCore(ram, opt = {}) {
    // 1: 'Extra sensitibe clay',
    // 2: 'Organic clay and peat',
    // 3: `Clay(su/p0'<=1)`,
    // 4: `Clay(su/p0'>1)`,
    // 5: 'Clayey sand',
    // 6: 'Sandy very clayey silt',
    // 7: 'Sandy silt',
    // 8: 'Silty sand',
    // 9: 'Clean to slightly silty sand',

    //numOfType
    let numOfType = get(opt, 'numOfType')
    if (numOfType !== 3 && numOfType !== 4 && numOfType !== 5 && numOfType !== 6) {
        console.log(`invalid numOfType[${numOfType}]`)
        numOfType = 3
    }

    //check
    if (!isnum(ram)) {
        return ''
    }

    //計算對應分類
    let i = cint(ram)
    if (numOfType === 3) { //簡化之3種土壤單元
        let kp = {
            1: 'clay',
            2: 'clay',
            3: 'clay',
            4: 'clay',
            6: 'silt',
            7: 'silt',
            5: 'sand',
            8: 'sand',
            9: 'sand',
        }
        if (haskey(kp, i)) {
            return kp[i]
        }
    }
    else if (numOfType === 4) { //前期的4種工程土壤單元
        let kp = {
            1: 'clay',
            2: 'clay',
            3: 'clay',
            4: 'clay',
            5: 'sand',
            6: 'clayey-silt',
            7: 'sandy-silt',
            8: 'sand',
            9: 'sand',
        }
        if (haskey(kp, i)) {
            return kp[i]
        }
    }
    else if (numOfType === 5) { //前期的5種基本土壤單元(其中silt此處用clayey-silt)
        let kp = {
            1: 'clay',
            2: 'clay',
            3: 'clay',
            4: 'clay',
            5: 'silty-sand', //clayey-sand需被視為silty-sand
            6: 'clayey-silt',
            7: 'sandy-silt',
            8: 'silty-sand',
            9: 'sand',
        }
        if (haskey(kp, i)) {
            return kp[i]
        }
    }
    else if (numOfType === 6) { //6種基本土壤單元, 主要為前期的4種基本土壤單元(其中silt此處用clayey-silt)+由silty-sand分開的silty-sand與clayey-sand
        let kp = {
            1: 'clay',
            2: 'clay',
            3: 'clay',
            4: 'clay',
            5: 'clayey-sand',
            6: 'clayey-silt',
            7: 'sandy-silt',
            8: 'silty-sand',
            9: 'sand',
        }
        if (haskey(kp, i)) {
            return kp[i]
        }
    }
    return ''
}


function simplifyRamsey(iRamFrQt, iRamBqQt, opt = {}) {

    //returnZone
    let returnZone = get(opt, 'returnZone')
    if (!isbol(returnZone)) {
        returnZone = false
    }

    //cint
    if (isnum(iRamFrQt)) {
        iRamFrQt = cint(iRamFrQt)
    }
    else {
        iRamFrQt = null
    }
    if (isnum(iRamBqQt)) {
        iRamBqQt = cint(iRamBqQt)
    }
    else {
        iRamBqQt = null
    }

    //simplifyRamseyCore
    let cFrQt = simplifyRamseyCore(iRamFrQt, opt)
    // console.log('simplifyRamseyCore cFrQt', cFrQt)
    let cBqQt = simplifyRamseyCore(iRamBqQt, opt)
    // console.log('simplifyRamseyCore cBqQt', cBqQt)

    if (iRamFrQt === null && iRamBqQt === null) {
        return ''
    }
    else if (iRamFrQt !== null && iRamBqQt === null) {
        return returnZone ? iRamFrQt : cFrQt
    }
    else if (iRamFrQt === null && iRamBqQt !== null) {
        return returnZone ? iRamFrQt : cBqQt
    }
    else if (cFrQt !== cBqQt) {
        //5,8,9視為砂性其他黏性, 若cFrQt與cBqQt皆為砂性則使用cBqQt, 反之則使用cFrQt
        let iRamFrQtIsSandy = iRamFrQt === 5 || iRamFrQt === 8 || iRamFrQt === 9
        let iRamBqQtIsSandy = iRamBqQt === 5 || iRamBqQt === 8 || iRamBqQt === 9
        if (iRamFrQtIsSandy && iRamBqQtIsSandy) {
            return returnZone ? iRamFrQt : cBqQt //皆砂性故使用cBqQt
        }
        else if (!iRamFrQtIsSandy && !iRamBqQtIsSandy) {
            return returnZone ? iRamFrQt : cFrQt //皆黏性故使用cFrQt
        }
        return '' //FrQt與BqQt分類不同, 兩者又是砂與黏性不同, 故視為無效分類, 交由其他深度做判斷
    }
    else {
        return returnZone ? iRamFrQt : cFrQt
    }
}


let cptClassify = {
    csfIc,

    csfRobRfqt,
    csfRobBqqt,

    csfRobBqQt,
    csfRobFrQt,

    csfRamBqQt,
    csfRamFrQt,
}


export {
    kpCPTClassForRobBqRfqt,
    kpCPTClassForRobBqFrQt,
    kpCPTClassForRamQt,
    getIcInfor,
    cptClassifyBond,
    cptClassify,
    simplifyRobertson1986,
    simplifyRobertson1990,
    simplifyRobertson2009,
    simplifyRamsey
}
